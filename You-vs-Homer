repeat task.wait() until game:IsLoaded() and game.Players.LocalPlayer


for i,v in pairs(getconnections(game:GetService("ScriptContext").Error)) do
    v:Disconnect()
end
coroutine.wrap(function()
    while task.wait(1) do
        for i,v in pairs(getconnections(game:GetService("ScriptContext").Error)) do
            v:Disconnect()
        end
    end
end)()


local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()


setclipboard("https://discord.gg/CdDUfPWQR4")


local Window = Rayfield:CreateWindow({
    Name = "Potatoware V2",
    Icon = 0,
    LoadingTitle = "Potatoware",
    LoadingSubtitle = "Made by Baconhaxxer1",  -- CHANGED HERE
    ShowText = "Potatoware",
    Theme = "Default",
    ToggleUIKeybind = "K",
    DisableRayfieldPrompts = false,
    DisableBuildWarnings = false,
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "Potatoware",
        FileName = "Settings"
    },
    Discord = { Enabled = false },
    KeySystem = false
})

-- Store current slider values for respawn
local savedValues = {
    walkspeed = 16,
    jumppower = 50
}


local MainTab = Window:CreateTab("Main", "home")

MainTab:CreateSlider({
    Name = "Walk Speed",
    Range = {16, 250},
    Increment = 1,
    CurrentValue = 16,
    Flag = "walkspeed",
    Callback = function(v)
        savedValues.walkspeed = v
        local char = game.Players.LocalPlayer.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then hum.WalkSpeed = v end
        end
    end
})

MainTab:CreateSlider({
    Name = "Jump Power",
    Range = {50, 250},
    Increment = 1,
    CurrentValue = 50,
    Flag = "jumppower",
    Callback = function(v)
        savedValues.jumppower = v
        local char = game.Players.LocalPlayer.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then hum.JumpPower = v end
        end
    end
})

-- Fullbright toggle
local lighting = game:GetService("Lighting")
local origBright, origAmb, origOutAmb
MainTab:CreateToggle({
    Name = "Fullbright",
    Info = "Makes dark areas visible",
    Default = false,
    Flag = "fullbright",
    Callback = function(state)
        if state then
            origBright = lighting.Brightness
            origAmb = lighting.Ambient
            origOutAmb = lighting.OutdoorAmbient
            lighting.Brightness = 2
            lighting.Ambient = Color3.new(1,1,1)
            lighting.OutdoorAmbient = Color3.new(1,1,1)
        else
            lighting.Brightness = origBright or 1
            lighting.Ambient = origAmb or Color3.new(0,0,0)
            lighting.OutdoorAmbient = origOutAmb or Color3.new(0,0,0)
        end
    end
})

-- ========== RITUAL TAB ==========
local RitualTab = Window:CreateTab("Ritual", "sparkles")

-- Ritual Spin
local spinConnection = nil
local spinSpeed = 90 -- degrees per second

RitualTab:CreateToggle({
    Name = "Ritual Spin",
    Info = "Makes your character spin continuously",
    Default = false,
    Flag = "ritualspin",
    Callback = function(state)
        if spinConnection then spinConnection:Disconnect() spinConnection = nil end
        if state then
            local root = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if not root then return end
            spinConnection = game:GetService("RunService").Heartbeat:Connect(function(dt)
                root.CFrame = root.CFrame * CFrame.Angles(0, math.rad(spinSpeed) * dt, 0)
            end)
        end
    end
})

RitualTab:CreateSlider({
    Name = "Spin Speed",
    Range = {30, 1000}, -- wider range for noticeable difference
    Increment = 5,
    Suffix = "Â°/s",
    CurrentValue = 90,
    Flag = "spinspeed",
    Callback = function(v) spinSpeed = v end
})

-- Ritual Fly (platform lift)
local ritualFlyConnection = nil
local ritualFlySpeed = 10 -- studs per second
local platform = nil

RitualTab:CreateToggle({
    Name = "Ritual Fly",
    Info = "Rises on an invisible platform",
    Default = false,
    Flag = "ritualfly",
    Callback = function(state)
        if ritualFlyConnection then
            ritualFlyConnection:Disconnect()
            ritualFlyConnection = nil
        end
        if platform then
            platform:Destroy()
            platform = nil
        end
        if state then
            local char = game.Players.LocalPlayer.Character
            if not char then return end
            local root = char:FindFirstChild("HumanoidRootPart")
            if not root then return end

            platform = Instance.new("Part")
            platform.Name = "RitualPlatform"
            platform.Size = Vector3.new(10, 1, 10)
            platform.Position = root.Position - Vector3.new(0, 3, 0)
            platform.Anchored = true
            platform.CanCollide = true
            platform.Transparency = 1
            platform.Material = Enum.Material.SmoothPlastic
            platform.Parent = workspace

            ritualFlyConnection = game:GetService("RunService").Heartbeat:Connect(function(dt)
                if not platform or not platform.Parent then
                    ritualFlyConnection:Disconnect()
                    ritualFlyConnection = nil
                    return
                end
                platform.CFrame = platform.CFrame + Vector3.new(0, ritualFlySpeed * dt, 0)
            end)
        end
    end
})

RitualTab:CreateSlider({
    Name = "Fly Speed",
    Range = {5, 50},
    Increment = 1,
    Suffix = " studs/s",
    CurrentValue = 10,
    Flag = "ritualflyspeed",
    Callback = function(v) ritualFlySpeed = v end
})

-- ========== ESP TAB ==========
local ESPTab = Window:CreateTab("ESP", "eye")
local ESPHolder = Instance.new("Folder")
ESPHolder.Name = "PotatoESP"
ESPHolder.Parent = game:GetService("CoreGui")

local function createESP(player)
    if player == game.Players.LocalPlayer then return end
    local char = player.Character
    if not char then return end
    local root = char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
    if not root then return end

    local boxGui = Instance.new("BillboardGui")
    boxGui.Name = player.Name .. "_Box"
    boxGui.Adornee = root
    boxGui.Size = UDim2.new(0,50,0,70)
    boxGui.AlwaysOnTop = true
    boxGui.ResetOnSpawn = false
    local frame = Instance.new("Frame", boxGui)
    frame.Size = UDim2.new(1,0,1,0)
    frame.BackgroundColor3 = Color3.new(1,0,0)
    frame.BackgroundTransparency = 0.3
    frame.BorderSizePixel = 3
    frame.BorderColor3 = Color3.new(1,1,1)

    local nameGui = Instance.new("BillboardGui")
    nameGui.Name = player.Name .. "_Name"
    nameGui.Adornee = root
    nameGui.Size = UDim2.new(0,100,0,30)
    nameGui.StudsOffset = Vector3.new(0,4.5,0)
    nameGui.AlwaysOnTop = true
    nameGui.ResetOnSpawn = false
    local nameLabel = Instance.new("TextLabel", nameGui)
    nameLabel.Size = UDim2.new(1,0,1,0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = player.DisplayName or player.Name
    nameLabel.TextColor3 = Color3.new(1,1,1)
    nameLabel.TextStrokeColor3 = Color3.new(0,0,0)
    nameLabel.TextStrokeTransparency = 0.3
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.TextScaled = true

    boxGui.Parent = ESPHolder
    nameGui.Parent = ESPHolder
end

local espEnabled = false
ESPTab:CreateToggle({
    Name = "Enable ESP",
    Info = "Red box with player name above",
    Default = false,
    Flag = "esptoggle",
    Callback = function(state)
        espEnabled = state
        if state then
            for _, p in pairs(game.Players:GetPlayers()) do
                if p ~= game.Players.LocalPlayer and p.Character then
                    createESP(p)
                end
            end
        else
            ESPHolder:ClearAllChildren()
        end
    end
})

game.Players.PlayerAdded:Connect(function(p)
    p.CharacterAdded:Connect(function()
        task.wait(1)
        if espEnabled then createESP(p) end
    end)
end)

game.Players.PlayerRemoving:Connect(function(p)
    for _, child in pairs(ESPHolder:GetChildren()) do
        if child.Name:find(p.Name) then child:Destroy() end
    end
end)

-- ========== UTILITY TAB ==========
local UtilityTab = Window:CreateTab("Utility", "terminal")
UtilityTab:CreateButton({
    Name = "Load Wallhop",
    Info = "You vs Homer wallhop",
    Callback = function()
        local s, e = pcall(function()
            loadstring(game:HttpGet("https://rawscripts.net/raw/Universal-Script-You-vs-Homer-wallhop-91780"))()
        end)
        Rayfield:Notify({
            Title = "Wallhop",
            Content = s and "Loaded! Ctrl+1 to toggle" or "Failed: " .. tostring(e):sub(1,50),
            Duration = 3
        })
    end
})
UtilityTab:CreateButton({
    Name = "Open Console",
    Info = "Opens Roblox developer console",
    Callback = function()
        pcall(function() game:GetService("StarterGui"):SetCore("DevConsoleVisible", true) end)
    end
})


local SupportTab = Window:CreateTab("Support", "heart")
SupportTab:CreateButton({
    Name = "Discord Invite",
    Info = "Click to copy invite link",
    Callback = function()
        setclipboard("https://discord.gg/CdDUfPWQR4")
        Rayfield:Notify({ Title = "Discord", Content = "Invite copied!", Duration = 3 })
    end
})
SupportTab:CreateLabel("In Beta/WIP")


local SettingsTab = Window:CreateTab("Settings", "settings")
SettingsTab:CreateButton({
    Name = "Destroy UI",
    Info = "Remove everything and unload",
    Callback = function()
        if spinConnection then spinConnection:Disconnect() end
        if ritualFlyConnection then ritualFlyConnection:Disconnect() end
        if platform then platform:Destroy() end
        ESPHolder:Destroy()
        Rayfield:Destroy()
    end
})

-- ========== RESPAWN HANDLER ==========
game.Players.LocalPlayer.CharacterAdded:Connect(function(char)
    repeat task.wait() until char and char:FindFirstChildOfClass("Humanoid")
    local hum = char:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.WalkSpeed = savedValues.walkspeed
        hum.JumpPower = savedValues.jumppower
    end
    if spinConnection then spinConnection:Disconnect() spinConnection = nil end
    if ritualFlyConnection then ritualFlyConnection:Disconnect() ritualFlyConnection = nil end
    if platform then platform:Destroy() platform = nil end
end)


-- No
